{
	"info": {
		"_postman_id": "5891e3f5-5d3a-45dc-995c-9dcf0855a157",
		"name": "newshaad",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "https://admin.aspqa01us.acuitynext.io/api/v1/partners",
			"event": [
				{
					"listen": "test",
					"script": {
						"id": "bdc5c580-85f1-448b-ba58-ed560cdc52c2",
						"type": "text/javascript",
						"exec": [
							"var partnerCountAll = 9;//data.partnerCountAll;",
							"",
							"",
							"",
							"",
							"var property1 = \"partnerID\";//data.property1;",
							"",
							"var property2 = \"partnerKey\";//data.property1;",
							"",
							"var property3 = \"partnerName\";//data.property1;",
							"var encodedPat = encodePat('72cwherppis2lgz5gjcrahj6bunq5g5fhfdslkawzy6ie2lk24wa');",
							"function encodePat(pat) {",
							"",
							"  var b = new Buffer(':' + pat);",
							"",
							"   var s = b.toString('base64');",
							"",
							"",
							"",
							"return s;",
							"",
							"",
							"",
							"}",
							"",
							"",
							"//xhttp = new XMLHttpRequest();",
							"",
							"var rcode=pm.environment.get(\"response_code\");",
							"var testrunid=pm.globals.get(\"testrun\");",
							"console.log(\"post\"+testrunid);",
							"rcode=parseInt(rcode);",
							"",
							"    pm.test('Atrius.Partner.GetPartnerAll: Status code Expected: 200, Actual: '+ responseCode.code,function () {",
							"  try{",
							"        pm.response.to.have.status(rcode);",
							"        passed();",
							"        update_run();",
							"        }",
							"        catch(err)",
							"        {",
							"        send(err);",
							"         update_run();",
							"  throw err;",
							"        }",
							"",
							"    });",
							"",
							"",
							"/*",
							"    var jsonData = pm.response.json();",
							"",
							"",
							"",
							"    pm.test('Atrius.Partner.GetPartnerAll: Total count  Expected: '+ partnerCountAll+', Actual: '+jsonData.count, function () {",
							"try{",
							"       pm.expect(partnerCountAll).to.equal(jsonData.count);",
							"       }",
							"       catch(err)",
							"       {",
							"       send(err.message);",
							"     throw err;",
							"       }",
							"",
							"    });",
							"",
							"",
							"",
							"    pm.test('Atrius.Partner.GetPartnerAll: Property  Expected: '+ property1, function () {",
							"      try{",
							"        pm.expect(jsonData.result[0]).to.have.property(property1);",
							"        }",
							"        catch(err)",
							"        {",
							"        send(err.message);",
							"        throw err;",
							"        }",
							"",
							"    });",
							"",
							"",
							"",
							"    pm.test('Atrius.Partner.GetPartnerAll: Property  Expected: '+ property2, function () {",
							"      try{",
							"        pm.expect(jsonData.result[0]).to.have.property(property2);",
							"        }",
							"        catch(err)",
							"        {",
							"        send(err.message);",
							"     throw err;",
							"        }",
							"",
							"    });",
							"",
							"",
							"",
							"    pm.test('Atrius.Partner.GetPartnerAll: Property  Expected: '+ property3, function () {",
							"    try{",
							"        pm.expect(jsonData.result[0]).to.have.property(property3);",
							"        }",
							"        catch(err)",
							"        {",
							"        send(err.message);",
							"  throw err;",
							"        }",
							"    });",
							"",
							"*/",
							"",
							"",
							"",
							"",
							"function send(e)",
							"{",
							"    console.log(e.message);",
							"",
							"/*var encodedPat = encodePat('72cwherppis2lgz5gjcrahj6bunq5g5fhfdslkawzy6ie2lk24wa');",
							"function encodePat(pat) {",
							"",
							"  var b = new Buffer(':' + pat);",
							"",
							"   var s = b.toString('base64');",
							"",
							"",
							"",
							"return s;",
							"",
							"",
							"",
							"}*/",
							"",
							"",
							"/*pm.sendRequest({",
							"",
							"    url: 'https://testshaad.visualstudio.com/defaultcollection/nodetest/_apis/wit/workitems/$Bug?api-version=1.0',",
							"",
							"    method: 'POST',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json-patch+json'},",
							" body: {",
							"      mode: 'raw',",
							"",
							"        raw: JSON.stringify([{\"op\": \"add\",\"path\": \"/fields/System.Title\",\"value\": e.message}])",
							"",
							"     ",
							" }",
							"}, function (err, res) {",
							"",
							"   console.log(res.code);",
							"",
							"});",
							"*/",
							"",
							"",
							"pm.sendRequest({",
							"",
							"",
							"    url: `https://testshaad.visualstudio.com/newmantest/_apis/test/runs/${testrunid}/results?api-version=3.0-preview`,",
							"",
							"    method: 'POST',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json'},",
							" body: {",
							"      mode: 'raw',",
							"",
							"        raw: JSON.stringify(",
							"            [{",
							"  \t",
							"  \t\"testCase\": {",
							"\"id\": 173",
							"},\"testPoint\": {",
							"    \"id\": 7",
							"  },",
							"    ",
							"    \"priority\": 2,",
							"    \"outcome\": \"Failed\",",
							"    \"errorMessage\": e.message",
							"  }]",
							"            ",
							"            )",
							"",
							"     ",
							" }",
							"}, function (err, res) {",
							"",
							"   console.log(res.code);",
							"   ",
							"",
							"});",
							"",
							"",
							"",
							"}",
							"",
							"/*************--------------------------------------------*//////////////////////",
							"",
							"function update_run()",
							"{",
							"var d = new Date();",
							"",
							"pm.sendRequest({",
							"",
							"    url: `https://testshaad.visualstudio.com/newmantest/_apis/test/runs/${testrunid}?api-version=3.0`,",
							"",
							"    method: 'PATCH',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json'},",
							"  body: {",
							"  ",
							"  mode: 'raw',",
							"",
							"        raw: JSON.stringify({",
							"      ",
							"  \"state\":\"Completed\"",
							"  })",
							" ",
							"}}, function (err,res) {",
							"  ",
							"  console.log(JSON.stringify(res.json()));",
							"   // pm.globals.set(\"testrun\", res.json().id);",
							"})",
							"",
							"}",
							"",
							"",
							"function passed()",
							"    {",
							"     /*   var encodedPat = encodePat('72cwherppis2lgz5gjcrahj6bunq5g5fhfdslkawzy6ie2lk24wa');",
							"function encodePat(pat) {",
							"",
							"  var b = new Buffer(':' + pat);",
							"",
							"   var s = b.toString('base64');",
							"",
							"",
							"",
							"return s;",
							"",
							"",
							"",
							"}*/",
							"        ",
							"     pm.sendRequest({",
							"",
							"    url: `https://testshaad.visualstudio.com/newmantest/_apis/test/runs/${testrunid}/results?api-version=3.0-preview`,",
							"",
							"    method: 'POST',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json'},",
							" body: {",
							"      mode: 'raw',",
							"",
							"        raw: JSON.stringify(",
							"            [{",
							"  \t",
							"  \t\"testCase\": {",
							"\"id\": 173",
							"},\"testPoint\": {",
							"    \"id\": 7",
							"  },",
							"    ",
							"    \"priority\": 2,",
							"    \"outcome\": \"Passed\",",
							"    \"errorMessage\": \"passed with response code 200\"",
							"  }]",
							"            ",
							"            )",
							"",
							"     ",
							" }",
							"}, function (err, res) {",
							"",
							"   console.log(res.code);",
							"    update_run();",
							"   // update_run();",
							"",
							"});",
							"",
							"",
							"",
							"       }"
						]
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"id": "799e012e-dfd0-4408-9d8a-7e44b531dd53",
						"type": "text/javascript",
						"exec": [
							"var _ = require('lodash');",
							"var parseString = require('xml2js').parseString;",
							"var encodedPat = encodePat('72cwherppis2lgz5gjcrahj6bunq5g5fhfdslkawzy6ie2lk24wa');",
							"",
							"function encodePat(pat) {",
							"",
							"  var b = new Buffer(':' + pat);",
							"",
							"   var s = b.toString('base64');",
							"",
							"return s;",
							"",
							"}",
							"",
							"pm.sendRequest({",
							"",
							"    url: 'https://testshaad.visualstudio.com/newmantest/_apis/wit/workitems/173?fields=Microsoft.VSTS.TCM.Steps&api-version=4.1-preview',",
							"",
							"    method: 'GET',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json-patch+json'},",
							"  body: {},",
							"  json:true",
							"",
							"     ",
							" ",
							"}, function (err,res) {",
							"  ",
							"    var r=res.json();",
							"    var x=_.pick(r.fields,['Microsoft.VSTS.TCM.Steps']);",
							"  x=x['Microsoft.VSTS.TCM.Steps'];",
							"parseString(x, function (err, result) {",
							"          var api=result.steps.step[1].parameterizedString[1]._;   ",
							"      var r=result.steps.step[0].parameterizedString[1]._;",
							"     ",
							"      r=r.replace(\"&nbsp;\",'');",
							"      r=r.replace(/<[^>]+>/g, '');",
							"      ",
							"      api=api.replace(\"&nbsp;\",'');",
							"      api=api.replace(/<[^>]+>/g, '');",
							"/*   var y=r.split(\":\");",
							"   //console.log(y[1]);*/",
							"   pm.environment.set(\"response_code\", r);",
							"  // pm.environmnt.set(\"call\",\"api/v1/partners\");",
							"  pm.environment.set(\"variable_key\", api);",
							"    ",
							"});",
							"",
							"",
							"",
							"",
							"",
							"});",
							"var d = new Date();",
							"",
							"pm.sendRequest({",
							"",
							"    url: 'https://testshaad.visualstudio.com/newmantest/_apis/test/runs?api-version=1.0',",
							"",
							"    method: 'POST',",
							"",
							"    header: {'cache-control': 'no-cache', 'authorization': `Basic ${encodedPat}`,'Content-Type': 'application/json'},",
							"  body: {",
							"  ",
							"  mode: 'raw',",
							"",
							"        raw: JSON.stringify({",
							"      \"name\":\"NEWTEST\"+Date.now(),",
							"  \"state\":\"InProgress\",",
							"   \"plan\": {",
							"    \"id\": 171",
							"  },",
							"  \"startedDate\":d,",
							"  \"isAutomated\": false,",
							"  \"comment\": \"Automating Testing Using Postman/Newman\"",
							"  })",
							" ",
							"}}, function (err,res) {",
							"  ",
							"  console.log(\"pre\"+res.json().id);",
							"    pm.globals.set(\"testrun\", res.json().id);",
							"})",
							"",
							"",
							"",
							"",
							"",
							"",
							"",
							"",
							"",
							"//pm.globals.set(\"variable_key\", \"variable_value\");",
							"",
							"//pm.environment.set(\"variable_key\", \"variable_value\");",
							"",
							""
						]
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [
					{
						"key": "atr-subscription-key",
						"value": "fa734f6a8f544f6c99e462de74e689eb"
					},
					{
						"key": "atr-partner-id",
						"value": "F8920659-D3AF-4823-90C0-276C48FA9DFD"
					},
					{
						"key": "atr-request-source",
						"value": "TestWeb"
					}
				],
				"body": {},
				"url": {
					"raw": "https://admin.aspqa01us.acuitynext.io/{{variable_key}}",
					"protocol": "https",
					"host": [
						"admin",
						"aspqa01us",
						"acuitynext",
						"io"
					],
					"path": [
						"{{variable_key}}"
					]
				},
				"description": "new with pre and post test"
			},
			"response": []
		}
	]
}